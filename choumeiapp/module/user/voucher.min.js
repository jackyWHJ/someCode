define(["jquery","commonUtils","utils/module/tongdun"],function(i,n,t){var e="",s="",a=0,d=10,o=function(){n.addBack(),n.addMenu(),e=n.checkLogin(),e&&(s=e.userId,v(),i(document).bind("scroll",l))},c=function(t){var e;1==t.result?t.data.main.length>0?(e=u(t.data.main),i(".voucher-con  ul").append(e)):(i(document).unbind("scroll",l),1==a&&i(".voucher-con  .no-content").show()):n.alert(t.msg)},l=function(n){var t=i(document).height(),e=i(document).scrollTop(),s=i(window).height();e+s>=t&&v()},v=function(){n.ajaxRequest({data:{to:"voucherList",type:"User",body:{userId:s,page:a++,pageSize:d}},successCallback:c,url:apiConfig.userApi})},u=function(n){var t="";return i.each(n,function(i,n){var e="",s="";1==n.vStatus?e="not":2==n.vStatus?(e="ed",s="voucher-ed"):3==n.vStatus?e="not":5==n.vStatus&&(e="invalid",s="voucher-invalid"),t+='<li><div class="roll row '+e+'"><div class="row-title"></div><div class="line"></div><div class="row-logo"></div><div class="column small-4"><span>&yen;</span><b>'+n.vUseMoney+'</b></div><div class="column small-8"><div class="title">'+n.vcTitle+'</div><div class="content">'+n.limit+'</div><div class="time">'+n.vUseStart+" è‡³ "+n.vUseEnd+'</div></div><div class="'+s+'"></div></div></li>'}),t};return{init:o}});