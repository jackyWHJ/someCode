function submit(o){var t,e=$("#tel"),i=e.val();if(e.blur(),commonUtils.isPhone(i)){var n=commonUtils.getQueryString("vcSnOld"),r=commonUtils.getQueryString("vcSnNew");if(!n)return commonUtils.alert("活动编码有误"),!1;t=r?JSON.stringify({to:"getVoucher",type:"Activity",body:{mobilephone:i,vcSnOld:n,vcSnNew:r}}):JSON.stringify({to:"getVoucher",type:"Activity",body:{mobilephone:i,vcSnOld:n}}),$.ajax({url:apiConfig.userApi,method:"POST",data:{code:t},beforeSend:function(){if(0==$("#loadingDiv").length){var o='<div id="loadingDiv"><div><img src="../../../css/images/ajaxloader.gif"><p>努力加载中...</p></div></div>';$(o).appendTo($("body"))}$("#loadingDiv").show()},success:function(o){$("#loadingDiv").fadeOut(),o=$.parseJSON(o),1!=o.result?commonUtils.alert(o.msg):($("#money").text(o.data.main.useMoney),$("#phone").text(i),setTimeout(function(){$(".wrap").hide(),$(".ok").show()},100))},error:function(o,t){$("#loadingDiv").hide();var e="数据请求失败，请稍后再试!";"parseerror"===t&&(e="响应数据格式异常!"),"timeout"===t&&(e="请求超时，请稍后再试!"),"offline"===t&&(e="网络异常，请稍后再试!"),commonUtils.alert(e)}})}else commonUtils.alert("请输入有效的11位数号码",{},function(){e.addClass("has-error").focus()})}window.onload=function(){$("body").show();var o=$(window).height(),t=$(".wrap").height();o>t&&$(".bottom").height(o-t)},$("#tel").on("keyup",function(o){$(this).hasClass("has-error")&&$(this).removeClass("has-error")}),$("#tel").on("focus",function(o){$(this).attr("type","tel")}),$("#tel").on("blur",function(o){$(this).attr("type","text")}),$(document).on("keyup",function(o){13===o.keyCode&&submit(o)}),$("#search").on("touchend",function(o){submit(o)});