define(["jquery","commonUtils"],function(e,a){var s,t,n,o,i,p,c=function(){if(a.addBack(),a.addMenu(),o=a.getQueryString("articleCodeId"),s=a.getQueryString("beautySn"),s||o)a.request({data:{orderSn:s,articleCodeId:o},url:apiConfig.newApi+"booking/ticket.html",successCallback:function(e){0!=e.code?a.alert(e.message):d(e.response)}});else{var e=JSON.parse(sessionStorage.getItem("appoint-ticket"));e?d(e):a.alert("暂无订单信息")}},d=function(a){console.dir(a),p=a.bookingSn,"Y"==a.isGift?(e("#giftInfo").show(),e("#payInfo").hide(),e("#itemName").html('<span class="appoint-gift">赠品</span>'+a.bookingItemNames),e("#giftDesc").text(a.present||"暂无描述"),e("#giftTip").show()):e("#itemName").text(a.bookingItemNames),i=a.payableAmount,e("#bookingSn").text(p),e("#bookingDate").text(a.bookingDate),e("#bookerName").text(a.bookerName),e("#amount").text("￥"+i),e("#paiedTime").text(a.paiedTime),a.recommendedCode?e("#recommendedCode").text(a.recommendedCode):e("#recommendedCode").parent().hide(),e("#beautyName").text(a.beautyName),e("#beautyAddress").text(a.beautyAddress).closest(".appoint-section").on("click",function(){location=a.h5Url}),s=a.orderSn,t=a.beautyId,n=a.itemType;var o=e("#status"),c=e("#statusInfo");switch(a.status){case"NEW ":o.text("未支付");break;case"PYD":o.text("未消费"),"Y"==a.isGift?"":r();break;case"CSD":o.text("已完成"),c.append('<div class="appoint-row"><span class="tip">完成时间  </span><span class="val">'+a.completeTime+"</span>").show();break;case"RFN":o.text("退款中"),c.append('<div class="appoint-row"><span class="tip">申请退款时间  </span><span class="val">'+a.askRefundTime+"</span>").show();break;case"RFD":o.text("已退款"),c.append('<div class="appoint-row"><span class="tip">申请退款时间  </span><span class="val">'+a.askRefundTime+'</span></div><div class="appoint-row"><span class="tip">退款时间  </span><span class="val">'+a.refundTime+'</span></div><div class="appoint-row"><span class="tip">退款金额  </span><span class="val">￥'+a.refundMoney+"</span></div>").show();break;case"RFD-OFL":o.text("已退款"),c.append('<div class="appoint-row"><span class="tip">退款时间  </span><span class="val">'+a.refundTime+'</span></div><div class="appoint-row"><span class="tip">已线下退款  </span>').show();break;case"GFT-OVT":o.text("已过期")}},r=function(){e("#refund").show().on("click",function(){location="../user/applyRefunds.html?orderSn="+s+"&salonId="+t+"&itemType="+n+"&money="+i+"&bookingSn="+p})};return{init:c}});