define(["jquery","commonUtils"],function(t,i){var o="",s={},a={},e={},n=function(){s=i.checkLogin(),s&&(o=s.userId),i.addBack(),i.addMenu(),l.getData(),i.goTop()},l={getData:function(){i.request({data:{userId:o},successCallback:l.getCallBack,url:apiConfig.newApi+"order/refund-list.html"})},getCallBack:function(i){if(0==i.code){var o=i.response.items,s=o.length,e=[];0==s&&t("#noContentTips").show(),t.each(o,function(t,i){var o=i.status,s=i.orderSn,n=i.ticketNo,l=Math.random(),r=l++;e.push('<div class="order-list">'),e.push('<p class="ol-header"><span class="text-overflow">'+i.salonName+"</span>"),"5"==o?e.push('<em class="main-color">退款中</em>'):e.push("<em>已退款</em>"),n?e.push('</p><div class="ol-info" itemId ='+i.itemId+" ticketNo="+i.ticketNo+">"):"8"==o?e.push('</p><div class="ol-info" orderSn ='+s+" >"):e.push('</p><div class="ol-info" orderSn ='+s+" status="+o+">"),e.push('<img onerror="this.src=\'../../images/default_img.png\'" src="'+i.imgUrl+'" class="oli-img"/>'),e.push('<div class="oli-right"><p class="olir-text1 text-overflow">'+i.itemName),e.push('</p><p class="olir-text2">'+(n?"臭美价":"预约金")+'<span class="main-color">￥'+i.money+"</span></p>"),e.push('<p class="olir-text3">购买时间：'+i.payTime+"</p></div>"),e.push('</div><p class="ol-bottom">'),n?e.push('<span class="olb-btn" ticketNo='+n+" dataKey="+r+" >退款详情</span>"):"8"==o?e.push('<span class="olb-btn" orderSn ='+s+" dataKey="+r+" status="+o+">退款详情</span>"):e.push('<span class="olb-btn" orderSn ='+s+" dataKey="+r+">退款详情</span>"),e.push("</p></div></div>"),a[r]=i}),t("#myRefundsBox").append(t(e.join(""))),l.addListener()}},addListener:function(){t(".olb-btn").off("click").on("click",function(){e=a[t(this).attr("dataKey")],window.sessionStorage.setItem("item",JSON.stringify(e)),window.localStorage.setItem("item",JSON.stringify(e));var i=t(this).attr("ticketNo"),o=t(this).attr("orderSn"),s=t(this).attr("status");i?window.location="refundsDetail.html?ticketNo="+i:s?window.location="../appoint/appoint-detail.html?beautySn="+o:window.location="refundsDetail.html?orderSn="+o}),t(".ol-info").off("click").on("click",function(){var i=t(this).attr("itemId"),o=t(this).attr("ticketNo"),s=t(this).attr("orderSn"),a=(t(this).attr("bookingSn"),t(this).attr("status"));o?window.location="../home/itemDetail.html?itemId="+i:a?window.location="../appoint/appoint-detail.html?beautySn="+s:window.location="refundsDetail.html?orderSn="+s})},addPageScrollListener:function(){var i=t(document).height(),o=t(document).scrollTop(),s=t(window).height();o+s>=i&&unUse.getUnUseData()}};return{init:n}});