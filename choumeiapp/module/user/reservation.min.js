define(["jquery","commonUtils"],function(n,e){var t="",i={},o=1,a=20,r=function(){i=e.checkLogin(),i&&(t=i.userId),e.addBack(),e.addMenu(),s.getData(),e.goTop()},s={getData:function(){var n={userId:t,pageNum:o,pageSize:a};e.request({data:n,successCallback:this.getCallBack,url:apiConfig.newApi+"user/my-semipermanent.html"})},getCallBack:function(e){if(0==e.code){var e=e.response,t=e.items,i=t.length,r=[];0==i&&1==o&&n("#noContentTips").show(),n.each(t,function(n,e){r.push('<li><div class="rbl-content" orderSn="'+e.orderSn+'" bookingSn="'+e.bookingSn+'">'),r.push('<img onerror="this.src=\'../../images/default_img.png\'" src="'+e.salonUrl+'" alt="">'),r.push('<div class="rblc-right"><p class="rblcr-title text-overflow">'+e.itemName+"</p>"),r.push('<p class="rblcr-text">预约金<span class="main-color">￥'+e.bookingMoney+"</span></p>"),r.push('<p class="rblcr-text">预约时间:'+e.bookingTime+"</p></div>"),r.push('</div> <p class="rbl-name">'+e.salonName+"</p></li>")}),n("#reservationBox ul").append(n(r.join(""))),i>=a&&1==o&&n(document).bind("scroll",s.addPageScrollListener),o++,s.addClickListener()}},addClickListener:function(){n(".rbl-content").off("click").on("click",function(){var e=n(this).attr("orderSn");window.location="../appoint/appoint-detail.html?beautySn="+e})},addPageScrollListener:function(){var e=n(document).height(),t=n(document).scrollTop(),i=n(window).height();t+i>=e&&s.getData()}};return{init:r}});