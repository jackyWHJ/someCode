var order=function(){var r="",e=1,o=10,a=1,i=function(){var e=commonUtils.checkLogin();e&&(r=e.userId,s(),d(),n())},s=function(){var i={type:"order",to:"notPayOrder",body:{}};i.body.userId=r,i.body.page=e,i.body.pageSize=o,commonUtils.ajaxRequest({url:apiConfig.orderApi,data:i,successCallback:function(r){r.result?r.result&&r.data.main.length>0?(t(r.data.main),a=parseInt((+r.data.other.totalNum+o-1)/o),$(document).on("scroll",l)):($("#order_list_id").removeClass("section-bg-color"),$(".no-result").show()):commonUtils.showTip(r.msg||"获取订单列表失败！")}})},t=function(r){var e="";r.forEach(function(r,o){e+='<div class="background-line"></div>',e+='<div class="order-start">',e+='<div class="order-info-des">',e+='<div class="order-salon-name">',e+='<div class="salon-name" salonId="'+r.salonId+'">'+r.salonName+"</div>",e+='<div class="limit-activity">',2==r.itemType&&(e+='<img class="limit-flag" src="../../images/user/tongyong_xianshitejia@2x.png">'),e+="</div></div>",e+='<div class="gray-line"></div>',e+='<div class="order-salon-title" orderId="'+r.orderId+'" itemType="'+r.itemType+'">',e+='<div class="salon-image-box"><img class="salon-image" src="'+r.img+'"></div>',e+='<div class="act-des-box">',e+='<div class="act-name" itemId="'+r.itemId+'">'+r.itemName+"</div>",e+='<div class="act-norms">'+(r.norms||"无规格")+"</div>",e+='<div class="act-price">',e+='<p >臭美价：<span class="font-color">￥'+r.priceAll+"</span>",1==r.itemType&&(e+='<span class="price-span">原价：￥'+r.priceOri+"</span>"),e+="</p></div></div></div>",e+='<div class="gray-line"></div>',e+='<div class="order-salon-pay">',1==r.isCanPay?(r.repertory>0&&(e+='<div class="inventory-num"><span>库存：'+r.repertory+"</span></div>"),e+='<div class="order-pay-btn" ordersn="'+r.orderSn+'">付款</div>'):2==r.isCanPay&&(e+='<div class="inventory-num gray"><span>已售罄</span></div>',e+='<div class="order-pay-btn pay-gray">付款</div>'),e+="</div></div>",e+='<div class="order-info-del" orderId="'+r.orderId+'">',e+='<span class="del-btn-text">删除</span></div></div>'},this),$(".order-list-box").append(e),commonUtils.imgError()},d=function(){$(".order-list-box").off()},n=function(){$(".order-list-box").delegate(".order-salon-name","click",c),$(".order-list-box").delegate(".order-info-del","click",p),$(".order-list-box").delegate(".order-salon-title","click",v),$(".order-list-box").delegate(".order-pay-btn","click",m)},l=function(){var r=$(document).height(),o=$(document).scrollTop(),i=$(window).height();o+i>=r&&a>e&&(e++,s())},c=function(r){var e=$(r.currentTarget.parentNode),o=e.next();"block"==o.css("display")?o.fadeOut("slow",function(){e.removeClass("right-move")}):(e.addClass("right-move"),o.fadeIn("slow"))},v=function(r){var e=$(r.currentTarget).attr("orderId"),o=$(r.currentTarget).attr("itemType");location.href="noPayOrderDetail.html?orderId="+e+"&itemType="+o},m=function(r){var e=$(r.target),o=e.attr("ordersn");e.hasClass("pay-gray")||(location.href="../cart/cartOrder.html?orderSn="+o)},p=function(e){var o=$(e.currentTarget),a={type:"order",to:"deleteOrder",body:{}};a.body.userId=r,a.body.orderId=o.attr("orderId"),commonUtils.confirm("你确定要删除吗？",function(r){r?commonUtils.ajaxRequest({url:apiConfig.orderApi,data:a,successCallback:function(r){r.result?(o.parent().prev().remove(),o.parent().remove(),0==$(".order-list-box").children().length&&($("#order_list_id").removeClass("section-bg-color"),$(".no-result").show())):(commonUtils.showTip(r.msg||"订单删除失败！"),o.fadeOut("slow",function(){o.prev().removeClass("right-move")}))}}):o.fadeOut("slow",function(){o.prev().removeClass("right-move")})})};return{Init:i}}();order.Init();