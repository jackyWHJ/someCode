define(["jquery","commonUtils"],function(e,t){var n="",s={},r="",i="",o="",a="",u="",l="",d="",c="",f=e("#hairdressRefunds"),m=e("#reservationRefunds"),g=function(){s=t.checkLogin(),s?n=s.userId:(t.alert("你还没登录！请先登录！"),window.sessionStorage.setItem("location",window.location),window.location="userLogin.html"),t.addBack(),t.addMenu(),r=t.getQueryString("priceAll"),i=t.getQueryString("ticketNo"),l=t.getQueryString("orderSn"),d=t.getQueryString("bookingSn"),c=t.getQueryString("payableAmount"),u=t.getQueryString("itemType"),"FM"==u?(m.hide(),f.show(),e("#hairdressNo").text(i.substring(0,4)+" "+i.substring(4,8)),e("#hairdressAmount").text("￥"+r)):(f.hide(),m.show(),e("#reservationNo").text(d),e("#reservationAmount").text("￥"+c)),w(),h()},h=function(){e("#confirmRefunds").on("click",function(){if(a="",o=e("#hairdressRefundsStyle").find(".select-current").index()+1,e(".refunds-reason>.arfa-text").each(function(t,n){var s=e(n).attr("data-status");"current"==s&&(a+=t+",")}),a=a.substring(0,a.length-1),a.length<1)return t.alert("请选择至少一项退款原因"),!1;if("FM"==u){var s={to:"ticketRefundDo",type:"Fundflow",body:{userId:n,ticketNo:i,reType:o,reReason:a}};t.ajaxRequest({data:s,successCallback:function(e){e.result?(t.showTip("申请退款成功，请耐心等待！"),setTimeout(function(){window.location="myRefunds.html"},500)):t.showTip(e.msg)},url:apiConfig.orderApi})}else{var s={userId:n,reReason:a,bookingSn:d,orderSn:l,salonId:salonId,itemType:u};t.request({data:s,successCallback:function(e){1==e.rusult?(t.showTip("已收到你的退款申请"),setTimeout(function(){window.location="refundsDetail.html?itemType="+u},500)):t.showTip(e.msg)},url:apiConfig.newApi+"order/booking-order-refund.html"})}})},w=function(){e("#hairdressRefundsStyle>.arfa-text").on("click",function(){e(this).addClass("select-current").removeClass("select-normal").siblings().addClass("select-normal").removeClass("select-current"),o=e(this).index()}),e(".refunds-reason.arfa-text").on("click",function(){var t=e(this).attr("data-status");"normal"==t?(e(this).addClass("select-current").removeClass("select-normal"),e(this).attr("data-status","current")):(e(this).addClass("select-normal").removeClass("select-current"),e(this).attr("data-status","normal"))})};return{init:g}});